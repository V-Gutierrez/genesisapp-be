(()=>{"use strict";var e={221:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=new(n(524).PrismaClient);t.default=r},765:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function o(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(n(349)),a=s(n(506)),o=s(n(221)),u=s(n(721)),c=s(n(142)),d=s(n(344));t.default=class{constructor(e){this.app=e,c.default.config(),this.authenticate()}authenticate(){return r(this,void 0,void 0,(function*(){this.app.post("/api/authenticate",((e,t)=>r(this,void 0,void 0,(function*(){const n=a.default.object().keys({email:a.default.string().email().required(),password:a.default.required()}),r=u.default.validateSchema(n,e.body);try{if(r)t.status(400).json({error:r});else{const{email:n,password:r}=e.body,s=yield o.default.user.findFirst({where:{email:n},select:{password:!0,email:!0}});if(s)if(yield i.default.comparePassword(s.password,r)){const e=d.default.sign({email:s.email},process.env.ACCESS_TOKEN_SECRET,{expiresIn:"12h"}),n=d.default.sign({email:s.email},process.env.REFRESH_TOKEN_SECRET,{expiresIn:"30d"});yield o.default.user.update({where:{email:s.email},data:{refreshToken:n}}),t.cookie("jwt",n,{httpOnly:!0,maxAge:2592e6}),t.status(200).json({userLoggedIn:!0,accessToken:e})}else t.sendStatus(401);else t.sendStatus(401)}}catch(e){t.sendStatus(500)}}))))}))}}},717:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(860)),i=r(n(142)),a=r(n(344)),o=r(n(582));t.default=class{constructor(e){this.app=e,i.default.config(),this.CORS(),this.Logger(),this.app.use(s.default.json()),this.app.use(s.default.urlencoded({extended:!1}))}CORS(){this.app.use((0,o.default)({origin:["http://localhost:3000","http://192.168.0.56:3000/","https://genesisproject-six.vercel.app"]}))}Logger(){this.app.use(((e,t,n)=>{console.log(`${e.method} ${e.url} --- Origin: ${e.headers.origin} - ${JSON.stringify(e.headers)}`),n()}))}static JWT(e){e.use(((e,t,n)=>{const r=e.headers.authorization;if(r){const e=r.split(" ")[1];a.default.verify(e,process.env.ACCESS_TOKEN_SECRET,((e,r)=>{e&&t.sendStatus(403),n()}))}else t.sendStatus(401)}))}}},226:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function o(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(n(221));t.default=class{constructor(e){this.app=e,this.get()}get(){this.app.get("/api/devotionals",((e,t)=>r(this,void 0,void 0,(function*(){try{const e=yield i.default.devotional.findMany();t.status(200).json(e)}catch(e){t.sendStatus(500)}}))))}}},96:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function o(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(n(221));t.default=class{constructor(e){this.app=e,this.getGrowthGroups()}getGrowthGroups(){return r(this,void 0,void 0,(function*(){this.app.get("/api/growthgroups",((e,t)=>r(this,void 0,void 0,(function*(){try{const e=yield i.default.growthGroup.findMany();t.status(200).json(e)}catch(e){t.sendStatus(500).json(null)}}))))}))}}},575:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function o(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(n(717)),a=s(n(349)),o=s(n(506)),u=s(n(221)),c=s(n(721));t.default=class{constructor(e){this.app=e,this.signUp(),i.default.JWT(this.app),this.get()}get(){return r(this,void 0,void 0,(function*(){this.app.get("/api/users/:id",((e,t)=>r(this,void 0,void 0,(function*(){const{id:n}=e.params;try{if(n){const e=yield u.default.user.findFirst({where:{id:n},select:{id:!0,email:!0,name:!0,createdAt:!0,birthdate:!0}});e||t.status(404).json({error:"User not found"}),e&&t.status(200).json(e)}else t.status(401).json({error:"Invalid or missing ID"})}catch(e){t.sendStatus(500)}}))))}))}signUp(){return r(this,void 0,void 0,(function*(){this.app.post("/api/users",((e,t)=>r(this,void 0,void 0,(function*(){const n=o.default.object().keys({email:o.default.string().email().required(),name:o.default.string().required(),phone:o.default.string().required().min(8).max(14),password:o.default.string().min(8),birthdate:o.default.string().required()}),r=c.default.validateSchema(n,e.body);try{if(r)t.status(400).json({error:r});else{const{email:n,name:r,password:s,phone:i,birthdate:o}=e.body;yield u.default.user.create({data:{email:n,name:r,birthdate:new Date(o).toISOString(),password:yield a.default.hashPassword(s),phone:i}}),t.status(201).json({message:"User created"})}}catch(e){"P2002"===e.code?t.status(409).json({error:"User already exists"}):t.status(500).json({error:"Internal server error"})}}))))}))}}},536:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(226)),i=r(n(96)),a=r(n(717)),o=r(n(575)),u=r(n(765));t.default=class{constructor(e){this.app=e,new a.default(this.app),new u.default(this.app),new o.default(this.app),new i.default(this.app),new s.default(this.app)}}},349:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(802));t.default=class{static hashPassword(e){return a.hash(e,10)}static comparePassword(e,t){return a.compare(e,t)}}},721:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(634)),u=a(n(506));t.default=class{static validateSchema(e,t){const{error:n}=u.default.validate(t,e,{abortEarly:!1,convert:!1});if(!n||!n.details)return;const r=n.details.map((({message:e,path:t})=>({[t.join(".")]:e})));return o.mergeAll(r)}}},920:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(536)),i=r(n(860));new class{constructor(e=(0,i.default)()){this.app=e,this.app.listen(process.env.PORT||5e3,(()=>new s.default(e)))}}},524:e=>{e.exports=require("@prisma/client")},802:e=>{e.exports=require("bcrypt")},582:e=>{e.exports=require("cors")},142:e=>{e.exports=require("dotenv")},860:e=>{e.exports=require("express")},506:e=>{e.exports=require("joi")},344:e=>{e.exports=require("jsonwebtoken")},634:e=>{e.exports=require("ramda")}},t={};!function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(920)})();